# 19110084, Võ Thị Huỳnh Hương

# Lab 2: CSRF attack

# Task 1: Normal transaction with CRSF vulnerability 

Step 1: Open terminal in the two files below

<img width="538" alt="Pic01" src="https://github.com/huong1232001/Lab_02/assets/103088804/024bac4b-adc9-424d-8c61-c33c26e925d1">

Step 2: Run the command: "python target.py"

<img width="693" alt="Pic02" src="https://github.com/huong1232001/Lab_02/assets/103088804/bd9c498f-cc7e-4fad-8168-99e5af10e8da">

Step 3: After running the above command, the terminal will display the URL "http://127.0.0.1:5000", copy that URL and search on Chorm

<img width="957" alt="Pic03" src="https://github.com/huong1232001/Lab_02/assets/103088804/eaa6d9f9-42b2-4460-aba0-00e2ab4ff8e3">

## 1.1. Login, Check balance

Step 4: Access to URL: "http://127.0.0.1:5000/login" to display the login page

<img width="951" alt="Pic04" src="https://github.com/huong1232001/Lab_02/assets/103088804/6cc50623-cfb9-47d6-a60b-c938907067c8">

Step 5: Log in to the user account "alice", with the password 'alice'

<img width="960" alt="Pic05" src="https://github.com/huong1232001/Lab_02/assets/103088804/58062082-56da-41d4-89b0-2d8d527a556b">

<img width="959" alt="Pic06" src="https://github.com/huong1232001/Lab_02/assets/103088804/feab7787-8dd4-46f8-9906-196a4964f3ba">

Step 6: Access the URL "http://127.0.0.1:5000/balance" to check Alice's account

<img width="957" alt="Pic07" src="https://github.com/huong1232001/Lab_02/assets/103088804/fe8be972-6bd7-4529-86c0-21b6899a7c53">

Step 7: Log in to the user account "bob", with the password 'bob'

<img width="952" alt="Pic08" src="https://github.com/huong1232001/Lab_02/assets/103088804/f239eb0a-552b-4a4f-b68c-1f8839457718">

<img width="959" alt="Pic09" src="https://github.com/huong1232001/Lab_02/assets/103088804/89dd5e41-e4a1-49b8-8ce9-e150f8f09cbb">

Step 8: Access the URL "http://127.0.0.1:5000/balance" to check Bob's account

<img width="960" alt="Pic10" src="https://github.com/huong1232001/Lab_02/assets/103088804/1540c908-f043-4d19-8914-c0e234900d24">

## 1.2. Doing the transaction

Step 1: Login with account "Alice", then access URL "http://127.0.0.1:5000/transfer" to transfer "4500" to user "Bob"

<img width="954" alt="Pic11" src="https://github.com/huong1232001/Lab_02/assets/103088804/2a39360a-2256-42f9-8313-6bceb6dd64b2">

<img width="957" alt="Pic12" src="https://github.com/huong1232001/Lab_02/assets/103088804/4478cd1d-b32a-4127-a80e-a46e55c7121c">

Step 2: Check Alice' account:

<img width="955" alt="Pic13" src="https://github.com/huong1232001/Lab_02/assets/103088804/225710db-ab97-4f2b-9f09-5a7e4c6b6a03">

Step 3: Check Bob' account:

<img width="960" alt="Pic14" src="https://github.com/huong1232001/Lab_02/assets/103088804/e7280579-9dff-4894-86cb-a600c2021458">

## 1.3. Tranfer money illegitimately

Step 1: Open hidden.html file from Chrome

<img width="957" alt="Pic15" src="https://github.com/huong1232001/Lab_02/assets/103088804/efd64ac3-0c29-4077-8b6a-6e1118a3e2c9">

Result: The current login account which is Alice got hacked. The html code automatically ran the moment user open the hidden_form.html

<img width="958" alt="Pic16" src="https://github.com/huong1232001/Lab_02/assets/103088804/0e43825e-6751-411f-921a-a4477f665f4b">

Step 2: Check Alice' balance

<img width="949" alt="Pic17" src="https://github.com/huong1232001/Lab_02/assets/103088804/35529aaa-93e9-4f56-8b41-fb5eb164bed6">

# Task 2: CSRF Countermeasure implementation

## 2.1. Solution 1:

Step 1: Import flask_wtf to process the CSRF token and the operating system to generate a random byte sequence of 32 bytes (256 bits).

<img width="275" alt="Pic18" src="https://github.com/huong1232001/Lab_02/assets/103088804/16a7f426-b876-4c01-824d-1b55c6ce8848">

Step 2: These strings are sufficiently unpredictable when associated with a user's session, making them suitable candidates for use as secret keys.

<img width="469" alt="Pic19" src="https://github.com/huong1232001/Lab_02/assets/103088804/728031f8-58f3-46ca-8321-6eaf243a4acb">

Step 3: Add to the html part of the function

<img width="552" alt="Pic20" src="https://github.com/huong1232001/Lab_02/assets/103088804/3a6622da-05a9-4ee4-bce1-d7c6984aa2f0">

Step 4: Result

<img width="182" alt="Pic21" src="https://github.com/huong1232001/Lab_02/assets/103088804/88457b47-f317-487a-bfe4-946ec1456da8">
























